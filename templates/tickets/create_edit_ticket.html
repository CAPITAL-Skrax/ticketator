{% extends "dashboard/index.html" %}

{%block content %}
	<div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">New ticket</h1>
                </div>
                <!-- /.col-lg-12 -->
    </div>
<!--Test if we go to ticket/create or if we submit ticket/number_of_ticket-->
<form method='post' action="/tickets/{%if form.instance.id%}{{form.instance.id}}{%else%}create{%endif%}" role="form">
{% csrf_token %}
    <div class="row">
                <div class="col-lg-8 col-md-offset-2">
                    <div class="panel panel-default">
                        <div class="panel-heading text-right">
                            Submit new ticket form
                        </div>

                        <div class="panel-body">
                            {% if vars.debug == True%}
                                    {% if form.errors %}
                                    <div class="alert alert-danger">
                                        {{ form.non_field_errors }}
                                    </div>
                                    {% endif %}
                                {%endif%}
                            <div class="row show-grid">
                                <!--<div class="col-lg-9" >-->
                                    <!--<div class="panel-body">-->
                                        <div class="col-md-2">
                                        <!--<div class="form-group">-->
                                                <label class="pull-center">Date</label>
                                                <input id="date" name="date" class="form-control" {% if form.instance.date%} value="{{form.instance.date|date:"d/m/y m:h:s"}}" readonly{% endif %}>
                                                {{form.date.errors}}
                                        <!--</div>-->
                                        </div>
                                        <!--<div class="form-group">-->
                                        <div class="col-md-2">
                                                <label class="pull-center">Priority</label>
                                                <select class="form-control" id="id_assigned_prio" name="assigned_prio">
                                                {% for prio in common_data.prio_info %}
                                                    {%if prio.id  == form.instance.assigned_prio.id %}
                                                        <option value="{{prio.id}}" selected >{{prio}}</option>
                                                    {%else%}
                                                        <option value="{{prio.id}}">{{prio}}</option>
                                                    {%endif%}
                                                {%endfor%}
                                                </select>
                                                <!--{{form.assigned_prio.errors}}-->
                                        <!--/div>-->
                                        </div>
                                        <div class="col-md-2">
                                        <!--<div class="form-group">-->
                                                <label class="pull-center">State</label>
                                                <select class="form-control" id="id_assigned_state" name="assigned_state">
                                                {% for status in common_data.status_info %}
                                                    {%if status.id  == form.instance.assigned_state.id %}
                                                        <option value="{{status.id}}" selected >{{status}}</option>
                                                    {%else%}
                                                        <option value="{{status.id}}">{{status}}</option>
                                                    {%endif%}
                                                {%endfor%}
                                                </select>
                                                {{form.assigned_state.errors}}
                                        <!-- </div> -->
                                        </div>
                                        <div class="col-md-2">
                                                <label class="pull-centert">Reponsible</label>
                                                <select class="form-control" id="id_assigned_user" name="assigned_user">
                                                <option disabled selected> --select-- </option>
                                                {% for responsable in common_data.users_info %}
                                                    {% if responsable.id == form.instance.assigned_user.id%}
                                                        <option value="{{responsable.id}}" selected >{{responsable}}</option>
                                                    {% else %}
                                                        <option value="{{responsable.id}}">{{responsable}}</option>
                                                    {% endif %}

                                                {%endfor%}
                                                </select>
                                                {{form.assigned_user.errors}}
                                        <!-- </div> -->
                                        </div>
                                        
                                        <div class="col-md-2">
                                        <!-- <div class="form-group"> -->
                                                <label class="pull-center">Department</label>
                                                <select class="form-control" id="id_assigned_department" name="assigned_department">
                                                <option disabled selected> --select-- </option>
                                                {% for dept in common_data.dept_info %}
                                                    {% if dept.id == form.instance.assigned_department.id %}
                                                    <option value="{{dept.id}}" selected >{{dept}}</option>
                                                    {% else %}
                                                    <option value="{{dept.id}}" >{{dept}}</option>
                                                    {% endif %}
                                                {%endfor%}
                                                </select>
                                                {{form.assigned_department.errors}}
                                        <!-- </div> -->
                                        </div>

                                        <!---Company-->
                                        <div class="col-md-2">
                                        <!-- <div class="form-group"> -->
                                                <label class="pull-center">Company</label>
                                                <select class="form-control" id="id_assigned_company" name="assigned_company">
                                                <option disabled selected> --select-- </option>
                                                {% for comp in common_data.comp_info %}
                                                    {% if comp.id == form.instance.assigned_company.id %}
                                                    <option value="{{comp.id}}" selected >{{comp}}</option>
                                                    {% else %}
                                                    <option value="{{comp.id}}" >{{comp}}</option>
                                                    {% endif %}
                                                {%endfor%}
                                                </select>
                                                {{form.assigned_company.errors}}
                                        <!-- </div> -->
                                        </div>

                                        <!-- <div class="form-group"> -->
                                        

                                    <!--</div>-->
                                <!--</div>-->
                            </div>

                            <div class="row">
                                <div class="col-lg-12">
                                        <div class="form-group">
                                            <label>Subject:</label>
                                            <input id="subject" name="subject" class="form-control" placeholder="Brief description about your ticket (yes, brief...)" {% if form.instance.subject %} value="{{form.instance.subject}}" {% endif %}>
                                            {{form.subject.errors}}
                                            
                                        </div>
                                        <div class="form-group">
                                            <label>Description:</label>
                                            <textarea id="body" name="body" rows="5" placeholder="Describe now your problem, with more detail..." class="form-control">{% if form.instance.body %}{{form.instance.body}}{%endif%}</textarea>
                                            {{form.body.errors}}
                                        </div>
                                </div>
                                
                            </div>
                            	<div class="row">
                         			<div class="colg-lg-9">
                         				<div class="form-group">
                         					<hr></hr>
                            <!--submit-->
                         				<button class="btn btn-default pull-right" style="margin-right: 20px" type="submit">Save ticket</button>
                                      	<button class="btn btn-default pull-left" style="margin-left: 20px" type="reset">Clear form</button>
                                      	</div>
                         			</div>
                         		</div>

                            <!-- /.row (nested) -->
                        </div>
                        <!-- /.panel-body -->
                        
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.main row -->
</form>

{%endblock%}